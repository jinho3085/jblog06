<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="post">
	
	<!-- 포스트 등록 -->
	<insert id="insert" parameterType="postvo">
		<![CDATA[
		INSERT INTO post (title, content, reg_date, category_no) 
		VALUES (#{title}, #{content}, NOW(), #{categoryNo})
		]]>
	</insert>
	
	<!-- 특정 카테고리의 포스트 목록 -->
	<select id="findByCategoryNo" resultType="postvo" parameterType="long">
		<![CDATA[
		  SELECT no, title, content, reg_date, category_no 
		  FROM post 
		  WHERE category_no = #{categoryNo} 
		  ORDER BY reg_date DESC
		]]>
	</select>
	
	<!-- 최신 글 하나 가져오기 (블로그 홈화면용) -->
	<select id="findLatestByBlogId" resultType="postvo" parameterType="string">
		<![CDATA[
		  SELECT p.no, p.title, p.content, p.reg_date, p.category_no 
		  FROM post p JOIN category c ON p.category_no = c.no 
		  WHERE c.blog_id = #{blogId} 
		  ORDER BY p.reg_date 
		  DESC LIMIT 1
		]]>
	</select>

</mapper>